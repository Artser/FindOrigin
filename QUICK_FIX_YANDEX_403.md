# Быстрое исправление ошибки 403 Yandex GPT

## Проблема сохраняется

Если вы привязали облако и добавили роли, но ошибка 403 все еще возникает, проверьте:

## Быстрая проверка

### 1. Правильность YANDEX_FOLDER_ID

`YANDEX_FOLDER_ID` должен быть **ID каталога** из привязанного облака.

**Как найти:**
1. Откройте https://console.cloud.yandex.ru/
2. Выберите ваше облако
3. Перейдите в **"Каталоги"**
4. Выберите каталог
5. ID каталога будет в URL или в настройках (формат: `b1g...`)

### 2. Права сервисного аккаунта

Сервисный аккаунт должен иметь роль `ai.languageModels.user` в каталоге:

1. Откройте https://console.cloud.yandex.ru/
2. Выберите облако → каталог
3. Перейдите в **"Управление доступом"**
4. Найдите сервисный аккаунт
5. Убедитесь, что есть роль `ai.languageModels.user` или `editor`

## Рекомендуемое решение: Использовать Google Custom Search API

Вместо Yandex GPT для поиска лучше использовать Google Custom Search API - он более надежен.

### Настройка Google Custom Search API:

1. **Получите API ключ и Search Engine ID:**
   - См. инструкцию в `GOOGLE_API_SETUP.md`
   - Или используйте уже имеющиеся ключи

2. **Добавьте в `.env.local`:**
   ```env
   GOOGLE_SEARCH_API_KEY=ваш_ключ_google
   GOOGLE_SEARCH_ENGINE_ID=ваш_id_google
   ```

3. **Перезапустите сервер:**
   ```powershell
   # Остановите сервер (Ctrl+C)
   npm run dev
   ```

4. **Проверьте работу:**
   - Откройте `http://localhost:3000`
   - Выполните поиск
   - Google API будет использоваться в первую очередь

## Альтернатива: Временно отключить Yandex GPT

Если хотите использовать другой API, закомментируйте Yandex в `.env.local`:

```env
# YANDEX_CLOUD_API_KEY=AQVN...
# YANDEX_FOLDER_ID=b1g...
# YANDEX_AUTH_TYPE=Api-Key
```

И настройте Google, Bing или SerpAPI.

## Приоритет поисковых API

После настройки Google API, порядок будет:
1. **Google Custom Search** (если настроен) ← будет использоваться первым
2. Bing Search (если настроен)
3. SerpAPI (если настроен)
4. Yandex GPT (если настроен, но с обработкой ошибок)

## После настройки Google API

Ошибка 403 должна исчезнуть, так как Google API будет использоваться вместо Yandex GPT для поиска.



