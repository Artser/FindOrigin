# Инструкция по настройке SerpAPI (альтернатива Google Custom Search)

Если у вас возникли проблемы с созданием поисковой системы в Google Custom Search, используйте **SerpAPI** - это более простой и надежный вариант.

## Преимущества SerpAPI

✅ **Проще настройка** - не нужно создавать поисковую систему  
✅ **100 бесплатных запросов в месяц** (вместо 100 в день у Google)  
✅ **Работает сразу** - только нужен API ключ  
✅ **Поддержка различных поисковых систем** (Google, Bing, Yahoo и др.)  
✅ **Не требует биллинга** для бесплатного тарифа  

## Шаг 1: Регистрация на SerpAPI

1. Перейдите на [SerpAPI.com](https://serpapi.com/)

2. Нажмите кнопку **"Sign Up"** (Регистрация) в правом верхнем углу

3. Заполните форму регистрации:
   - Email адрес
   - Пароль
   - Или войдите через Google/GitHub (быстрее)

4. Подтвердите email (проверьте почту и перейдите по ссылке)

## Шаг 2: Получение API ключа

1. После входа вы автоматически попадете в **Dashboard**

2. В верхней части страницы вы увидите ваш **API Key**

3. **Скопируйте API ключ** - он выглядит примерно так:
   ```
   abc123def456ghi789jkl012mno345pqr678stu901vwx234yz
   ```

   ⚠️ **Важно:** Не публикуйте этот ключ в открытом доступе!

## Шаг 3: Добавление ключа в проект

Откройте файл `.env.local` (или `.env`) и добавьте:

```env
SERPAPI_KEY=ваш_скопированный_api_ключ
```

**Пример:**
```env
SERPAPI_KEY=abc123def456ghi789jkl012mno345pqr678stu901vwx234yz
```

## Шаг 4: Проверка работы

### Проверка через PowerShell

```powershell
$apiKey = "ваш_serpapi_ключ"
$query = "test"
$url = "https://serpapi.com/search?engine=google&q=$query&api_key=$apiKey&hl=ru&gl=ru"
Invoke-WebRequest -Uri $url | Select-Object -ExpandProperty Content
```

Если все настроено правильно, вы увидите JSON с результатами поиска.

### Проверка через браузер

Откройте в браузере (замените `ВАШ_КЛЮЧ` на ваш API ключ):

```
https://serpapi.com/search?engine=google&q=test&api_key=ВАШ_КЛЮЧ&hl=ru&gl=ru
```

## Лимиты и тарифы

### Бесплатный тариф (Free Plan)
- ✅ **100 запросов в месяц**
- ✅ Без кредитной карты
- ✅ Достаточно для тестирования и небольших проектов

### Платные тарифы
- **Hobby**: $50/месяц - 5,000 запросов
- **Standard**: $250/месяц - 30,000 запросов
- И другие тарифы для больших объемов

## Настройка в проекте

После добавления `SERPAPI_KEY` в `.env.local`, проект автоматически будет использовать SerpAPI вместо Google Custom Search.

Код в `lib/searchSources.ts` уже поддерживает оба варианта:

```typescript
// Сначала пробует Google Custom Search
if (process.env.GOOGLE_SEARCH_API_KEY && process.env.GOOGLE_SEARCH_ENGINE_ID) {
  return await searchWithGoogle(query);
}

// Если Google не настроен, использует SerpAPI
if (process.env.SERPAPI_KEY) {
  return await searchWithSerpAPI(query);
}
```

## Устранение проблем

### Ошибка: "Invalid API key"
- Проверьте, что ключ скопирован полностью, без пробелов
- Убедитесь, что ключ добавлен в `.env.local` (не в `.env`)
- Перезапустите сервер разработки после изменения `.env.local`

### Ошибка: "Monthly search limit reached"
- Вы использовали все 100 бесплатных запросов в месяц
- Подождите до следующего месяца
- Или перейдите на платный тариф

### Ошибка: "Account suspended"
- Проверьте email от SerpAPI
- Убедитесь, что вы не нарушаете условия использования
- Свяжитесь с поддержкой SerpAPI

## Дополнительные возможности SerpAPI

SerpAPI поддерживает не только Google, но и другие поисковые системы:

- **Google** (по умолчанию)
- **Bing**
- **Yahoo**
- **Yandex**
- **DuckDuckGo**
- И другие

Для использования других поисковых систем можно изменить параметр `engine` в коде.

## Полезные ссылки

- [SerpAPI Dashboard](https://serpapi.com/dashboard)
- [Документация SerpAPI](https://serpapi.com/search-api)
- [Примеры использования](https://serpapi.com/search-api)
- [Тарифы](https://serpapi.com/pricing)

## Сравнение: Google Custom Search vs SerpAPI

| Параметр | Google Custom Search | SerpAPI |
|----------|----------------------|---------|
| Настройка | Сложная (нужно создать поисковую систему) | Простая (только API ключ) |
| Бесплатный лимит | 100 запросов/день | 100 запросов/месяц |
| Требуется биллинг | Для увеличения лимита | Не требуется |
| Поддержка других поисковиков | Только Google | Google, Bing, Yahoo, Yandex и др. |
| Надежность | Зависит от Google | Высокая |

## Рекомендация

Для быстрого старта и тестирования **рекомендуется использовать SerpAPI**, так как:
- Настройка занимает 2-3 минуты
- Не нужно создавать поисковую систему
- Работает сразу после получения ключа
- 100 запросов в месяц достаточно для тестирования

После того как проект заработает, можно при необходимости перейти на Google Custom Search или использовать оба варианта параллельно.


